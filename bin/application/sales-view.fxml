<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.cell.PropertyValueFactory?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane prefHeight="700.0" prefWidth="1200.0" style="-fx-background-color: #f8f9fa;" xmlns="http://javafx.com/javafx/25" xmlns:fx="http://javafx.com/fxml/1" fx:controller="application.SalesViewController">

    <top>
        <VBox style="-fx-background-color: linear-gradient(to right, #27ae60, #2ecc71);">
            <padding>
                <Insets bottom="20" left="30" right="30" top="20" />
            </padding>
            <children>
                <Label text="ðŸ’° VENTES DU JOUR" textFill="WHITE">
                    <font>
                        <Font name="System Bold" size="24.0" />
                    </font>
                </Label>
                <Label fx:id="summaryLabel" text="Chargement..." textFill="#e8f5e8">
                    <font>
                        <Font size="14.0" />
                    </font>
                </Label>
            </children>
        </VBox>
    </top>

    <center>
        <VBox spacing="15.0">
            <padding>
                <Insets bottom="20" left="20" right="20" top="20" />
            </padding>

            <!-- Date Filter and Statistics -->
            <HBox alignment="CENTER_LEFT" spacing="30.0">
                <VBox spacing="5.0">
                    <Label style="-fx-font-weight: bold;" text="PÃ©riode:" textFill="#4a5568" />
                    <HBox alignment="CENTER_LEFT" spacing="10.0">
                        <DatePicker fx:id="startDatePicker" prefWidth="150.0" />
                        <Label text="Ã " textFill="#4a5568" />
                        <DatePicker fx:id="endDatePicker" prefWidth="150.0" />
                        <Button fx:id="applyDateFilterButton" onAction="#applyDateFilter" style="-fx-background-color: #27ae60; -fx-background-radius: 5; -fx-text-fill: white; -fx-font-weight: bold; -fx-cursor: hand;" text="ðŸ” Appliquer" />
                    </HBox>
                </VBox>
                
                            <Button fx:id="todayButton" onAction="#setTodayFilter" style="-fx-background-color: #3182ce; -fx-background-radius: 5; -fx-text-fill: white; -fx-font-weight: bold; -fx-cursor: hand;" text="ðŸ“… Aujourd'hui" />
            </HBox>

            <!-- Sales Statistics -->
            <HBox alignment="CENTER" spacing="30.0" style="-fx-background-color: #edf2f7; -fx-padding: 15; -fx-background-radius: 10;">
                <VBox alignment="CENTER">
                    <Label style="-fx-font-weight: bold;" text="Total des Ventes" textFill="#4a5568" />
                    <Label fx:id="totalSalesLabel" style="-fx-font-size: 18; -fx-font-weight: bold;" text="0.00â‚¬" textFill="#27ae60" />
                </VBox>
                <VBox alignment="CENTER">
                    <Label style="-fx-font-weight: bold;" text="Transactions" textFill="#4a5568" />
                    <Label fx:id="transactionCountLabel" style="-fx-font-size: 18; -fx-font-weight: bold;" text="0" textFill="#27ae60" />
                </VBox>
                <VBox alignment="CENTER">
                    <Label style="-fx-font-weight: bold;" text="Vente Moyenne" textFill="#4a5568" />
                    <Label fx:id="averageSaleLabel" style="-fx-font-size: 18; -fx-font-weight: bold;" text="0.00â‚¬" textFill="#27ae60" />
                </VBox>
                <VBox alignment="CENTER">
                    <Label style="-fx-font-weight: bold;" text="Articles Vendus" textFill="#4a5568" />
                    <Label fx:id="totalItemsSoldLabel" style="-fx-font-size: 18; -fx-font-weight: bold;" text="0" textFill="#27ae60" />
                </VBox>
            </HBox>

            <!-- Sales Table -->
            <Label style="-fx-font-weight: bold; -fx-font-size: 16;" text="DÃ©tail des Transactions:" textFill="#2d3748" />
            <TableView fx:id="salesTable" prefHeight="300.0">
                <columns>
                    <TableColumn fx:id="saleIdColumn" prefWidth="100" text="ID Vente">
                        <cellValueFactory>
                            <PropertyValueFactory property="idVente" />
                        </cellValueFactory>
                    </TableColumn>
                    <TableColumn fx:id="saleDateColumn" prefWidth="120" text="Date">
                        <cellValueFactory>
                            <PropertyValueFactory property="date" />
                        </cellValueFactory>
                    </TableColumn>
                    <TableColumn fx:id="saleItemsColumn" prefWidth="80" text="Articles">
                        <cellValueFactory>
                            <PropertyValueFactory property="nombreArticles" />
                        </cellValueFactory>
                    </TableColumn>
                    <TableColumn fx:id="saleTotalColumn" prefWidth="100" text="Total (â‚¬)">
                        <cellValueFactory>
                            <PropertyValueFactory property="total" />
                        </cellValueFactory>
                    </TableColumn>
                    <TableColumn fx:id="saleDetailsColumn" prefWidth="150" text="DÃ©tails" />
                </columns>
            </TableView>

            <!-- Top Products -->
            <Label style="-fx-font-weight: bold; -fx-font-size: 16;" text="Articles les Plus Vendus:" textFill="#2d3748" />
            <TableView fx:id="topProductsTable" prefHeight="150.0">
                <columns>
                    <TableColumn fx:id="productNameColumn" prefWidth="200" text="Article">
                        <cellValueFactory>
                            <PropertyValueFactory property="nom" />
                        </cellValueFactory>
                    </TableColumn>
                    <TableColumn fx:id="quantitySoldColumn" prefWidth="120" text="QuantitÃ© Vendue">
                        <cellValueFactory>
                            <PropertyValueFactory property="quantiteVendue" />
                        </cellValueFactory>
                    </TableColumn>
                    <TableColumn fx:id="revenueColumn" prefWidth="150" text="Chiffre d'Affaires">
                        <cellValueFactory>
                            <PropertyValueFactory property="chiffreAffaires" />
                        </cellValueFactory>
                    </TableColumn>
                </columns>
            </TableView>
        </VBox>
    </center>

    <bottom>
        <HBox alignment="CENTER" spacing="20" style="-fx-padding: 15;">
            <Button fx:id="exportButton" onAction="#handleExportButton" style="-fx-background-color: #27ae60; -fx-background-radius: 5; -fx-text-fill: white; -fx-font-weight: bold; -fx-cursor: hand; -fx-padding: 10 20;" text="ðŸ’¾ Exporter Rapport" />
            <Button fx:id="printButton" onAction="#handlePrintButton" style="-fx-background-color: #3182ce; -fx-background-radius: 5; -fx-text-fill: white; -fx-font-weight: bold; -fx-cursor: hand; -fx-padding: 10 20;" text="ðŸ–¨ï¸ Imprimer" />
            <Button fx:id="refreshButton" onAction="#handleRefreshButton" style="-fx-background-color: #3182ce; -fx-background-radius: 5; -fx-text-fill: white; -fx-font-weight: bold; -fx-cursor: hand; -fx-padding: 10 20;" text="ðŸ”„ Actualiser" />
            <Button fx:id="backButton" onAction="#handleBackButton" style="-fx-background-color: #718096; -fx-background-radius: 5; -fx-text-fill: white; -fx-font-weight: bold; -fx-cursor: hand; -fx-padding: 10 20;" text="ðŸ”™ Retour" />
        </HBox>
    </bottom>
</BorderPane>
